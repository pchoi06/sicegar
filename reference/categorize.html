<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Categorize input data by comparing the AIC values of the three fitted models. — categorize • Analysis of Single-Cell Viral Growth Curves</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Categorize input data by comparing the AIC values of the three fitted models. — categorize"><meta name="description" content="Catagorizes the input data using the results of two model fitsand chosen thresholds."><meta property="og:description" content="Catagorizes the input data using the results of two model fitsand chosen thresholds."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Analysis of Single-Cell Viral Growth Curves</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/additional_parameters.html">Calculation of additional parameters of interest</a></li>
    <li><a class="dropdown-item" href="../articles/categorizing_fits.html">Identifying the best-fitting model category</a></li>
    <li><a class="dropdown-item" href="../articles/fitting_individual_models.html">Fitting individual models</a></li>
    <li><a class="dropdown-item" href="../articles/h0_functions.html">Allowing the lower asymptote parameter to vary freely</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/plotting_fitted_models.html">Plotting the fitted models</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hardin47/sicegar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Categorize input data by comparing the AIC values of the three fitted models.</h1>
      <small class="dont-index">Source: <a href="https://github.com/hardin47/sicegar/blob/master/R/categorize.R" class="external-link"><code>R/categorize.R</code></a></small>
      <div class="d-none name"><code>categorize.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Catagorizes the input data using the results of two model fitsand chosen thresholds.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">categorize</span><span class="op">(</span></span>
<span>  <span class="va">parameterVectorSigmoidal</span>,</span>
<span>  <span class="va">parameterVectorDoubleSigmoidal</span>,</span>
<span>  threshold_intensity_range <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  threshold_minimum_for_intensity_maximum <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  threshold_bonus_sigmoidal_AIC <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  threshold_sm_tmax_IntensityRatio <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  threshold_dsm_tmax_IntensityRatio <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  threshold_AIC <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>,</span>
<span>  threshold_t0_max_int <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  showDetails <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-parametervectorsigmoidal">parameterVectorSigmoidal<a class="anchor" aria-label="anchor" href="#arg-parametervectorsigmoidal"></a></dt>
<dd><p>Output of the sigmoidalFitFunction.</p></dd>


<dt id="arg-parametervectordoublesigmoidal">parameterVectorDoubleSigmoidal<a class="anchor" aria-label="anchor" href="#arg-parametervectordoublesigmoidal"></a></dt>
<dd><p>Output of the doublesigmoidalFitFunction.</p></dd>


<dt id="arg-threshold-intensity-range">threshold_intensity_range<a class="anchor" aria-label="anchor" href="#arg-threshold-intensity-range"></a></dt>
<dd><p>Minimum for intensity range, i.e. it is the lower limit for the allowed difference between the maximum and minimum of the intensities (Default is 0.1, and the values are based on actual, not the rescaled data.).</p></dd>


<dt id="arg-threshold-minimum-for-intensity-maximum">threshold_minimum_for_intensity_maximum<a class="anchor" aria-label="anchor" href="#arg-threshold-minimum-for-intensity-maximum"></a></dt>
<dd><p>Minimum allowed value for intensity maximum. (Default is 0.3, and the values are based on actual, not the rescaled data.).</p></dd>


<dt id="arg-threshold-bonus-sigmoidal-aic">threshold_bonus_sigmoidal_AIC<a class="anchor" aria-label="anchor" href="#arg-threshold-bonus-sigmoidal-aic"></a></dt>
<dd><p>Bonus AIC points for sigmoidal fit. Negative values help the sigmoidal model to win. Only helps in competition between sigmoidal and double sigmoidal fit at decision step "9", i.e. if none of the models fail in any of the tests and stay as a candidate until the last step (Default is 0).</p></dd>


<dt id="arg-threshold-sm-tmax-intensityratio">threshold_sm_tmax_IntensityRatio<a class="anchor" aria-label="anchor" href="#arg-threshold-sm-tmax-intensityratio"></a></dt>
<dd><p>The threshold for the minimum intensity ratio between the last observed time points intensity and theoretical maximum intensity of the sigmoidal curve. If the value is below the threshold, then the data can not be represented with the sigmoidal model. (Default is 0.85)</p></dd>


<dt id="arg-threshold-dsm-tmax-intensityratio">threshold_dsm_tmax_IntensityRatio<a class="anchor" aria-label="anchor" href="#arg-threshold-dsm-tmax-intensityratio"></a></dt>
<dd><p>The threshold for the minimum intensity ratio between the last observed time points intensity and maximum intensity of the double sigmoidal curve.  If the value is above the threshold, then the data can not be represented with the double sigmoidal model. (Default is 0.75)</p></dd>


<dt id="arg-threshold-aic">threshold_AIC<a class="anchor" aria-label="anchor" href="#arg-threshold-aic"></a></dt>
<dd><p>Maximum AIC values in order to have a meaningful fit (Default is -10).</p></dd>


<dt id="arg-threshold-t-max-int">threshold_t0_max_int<a class="anchor" aria-label="anchor" href="#arg-threshold-t-max-int"></a></dt>
<dd><p>Maximum allowed intensity of the fitted curve at time is equal to zero (t=0). (Default is 0.05, and the values are based on actual, not the rescaled data.).</p></dd>


<dt id="arg-showdetails">showDetails<a class="anchor" aria-label="anchor" href="#arg-showdetails"></a></dt>
<dd><p>Logical to chose if we want to see details or not. Default is "FALSE"</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The returned object contains extensive information about the decision process, but the key component is the decision variable. The decision variable can be one of the following four; "no_signal", "infection","infection&amp;lysis" or "ambugious".</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1 with double sigmoidal data</span></span></span>
<span class="r-in"><span><span class="va">time</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">24</span>, <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#simulate intensity data and add noise</span></span></span>
<span class="r-in"><span><span class="va">noise_parameter</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span></span>
<span class="r-in"><span><span class="va">intensity_noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">noise_parameter</span></span></span>
<span class="r-in"><span><span class="va">intensity</span> <span class="op">&lt;-</span> <span class="fu">sicegar</span><span class="fu">::</span><span class="fu"><a href="doublesigmoidalFitFormula.html">doublesigmoidalFitFormula</a></span><span class="op">(</span><span class="va">time</span>,</span></span>
<span class="r-in"><span>                                               finalAsymptoteIntensityRatio <span class="op">=</span> <span class="fl">.3</span>,</span></span>
<span class="r-in"><span>                                               maximum <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                                               slope1Param <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                               midPoint1Param <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>                                               slope2Param <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                               midPointDistanceParam <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">intensity</span> <span class="op">&lt;-</span> <span class="va">intensity</span> <span class="op">+</span> <span class="va">intensity_noise</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dataInput</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>intensity <span class="op">=</span> <span class="va">intensity</span>, time <span class="op">=</span> <span class="va">time</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">normalizedInput</span> <span class="op">&lt;-</span> <span class="fu">sicegar</span><span class="fu">::</span><span class="fu"><a href="normalizeData.html">normalizeData</a></span><span class="op">(</span><span class="va">dataInput</span>,</span></span>
<span class="r-in"><span>                                         dataInputName <span class="op">=</span> <span class="st">"sample001"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit sigmoidal model</span></span></span>
<span class="r-in"><span><span class="va">sigmoidalModel</span> <span class="op">&lt;-</span> <span class="fu">sicegar</span><span class="fu">::</span><span class="fu"><a href="multipleFitFunction.html">multipleFitFunction</a></span><span class="op">(</span>dataInput <span class="op">=</span> <span class="va">normalizedInput</span>,</span></span>
<span class="r-in"><span>                                              model <span class="op">=</span> <span class="st">"sigmoidal"</span>,</span></span>
<span class="r-in"><span>                                              n_runs_min <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>                                              n_runs_max <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>                                              showDetails <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit double sigmoidal model</span></span></span>
<span class="r-in"><span><span class="va">doubleSigmoidalModel</span> <span class="op">&lt;-</span> <span class="fu">sicegar</span><span class="fu">::</span><span class="fu"><a href="multipleFitFunction.html">multipleFitFunction</a></span><span class="op">(</span>dataInput <span class="op">=</span> <span class="va">normalizedInput</span>,</span></span>
<span class="r-in"><span>                                                    model <span class="op">=</span> <span class="st">"doublesigmoidal"</span>,</span></span>
<span class="r-in"><span>                                                    n_runs_min <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>                                                    n_runs_max <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>                                                    showDetails <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate additional parameters</span></span></span>
<span class="r-in"><span><span class="va">sigmoidalModel</span> <span class="op">&lt;-</span> <span class="fu">sicegar</span><span class="fu">::</span><span class="fu"><a href="parameterCalculation.html">parameterCalculation</a></span><span class="op">(</span><span class="va">sigmoidalModel</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">doubleSigmoidalModel</span> <span class="op">&lt;-</span> <span class="fu">sicegar</span><span class="fu">::</span><span class="fu"><a href="parameterCalculation.html">parameterCalculation</a></span><span class="op">(</span><span class="va">doubleSigmoidalModel</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">outputCluster</span> <span class="op">&lt;-</span> <span class="fu">sicegar</span><span class="fu">::</span><span class="fu">categorize</span><span class="op">(</span>parameterVectorSigmoidal <span class="op">=</span> <span class="va">sigmoidalModel</span>,</span></span>
<span class="r-in"><span>                                    parameterVectorDoubleSigmoidal <span class="op">=</span> <span class="va">doubleSigmoidalModel</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">outputCluster</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.name                               : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dataInputName                           : chr "sample001"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.sm_modelCheck                      : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.dsm_modelCheck                     : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.dataScalingParameters              : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ intensityMaximum                        : num 4.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ threshold_minimum_for_intensity_maximum : num 0.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.minimum_for_intensity_maximum      : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ intensityRange                          : num 4.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ threshold_intensity_range               : num 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.intensity_range                    : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.sigmoidalFit                       : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.doublesigmoidalFit                 : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.sigmoidalAdditionalParameters      : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.doublesigmoidalAdditionalParameters: logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ threshold_AIC                           : num -10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ sigmoidalAIC                            : num -4.51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.sigmoidalAIC                       : logi FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ doublesigmoidalAIC                      : num -1283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.doublesigmoidalAIC                 : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dsm_maximum_x                           : num 11.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ timeRange                               : num 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.dsm_maximum_x                      : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ sm_tmax_IntensityRatio                  : num 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ threshold_sm_tmax_IntensityRatio        : num 0.75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.sm_tmax_IntensityRatio             : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dsm_tmax_IntensityRatio                 : num 0.314</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ threshold_dsm_tmax_IntensityRatio       : num 0.75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.dsm_tmax_IntensityRatio            : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ sm_startPoint_x                         : num 4.76</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.sm_startPoint_x                    : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dsm_startPoint_x                        : num 4.81</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.dsm_startPoint_x                   : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ sm_startIntensity                       : num 6.79e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ threshold_t0_max_int                    : num 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.sm_startIntensity                  : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dsm_startIntensity                      : num 0.00708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ test.dsm_startIntensity                 : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ decisonSteps                            : chr "1c_3a_8"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ decision                                : chr "double_sigmoidal"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johanna Hardin, Samuel Butler, Phineus Choi, Thomas Matheis, M. Umut Caglar, Claus O. Wilke.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

