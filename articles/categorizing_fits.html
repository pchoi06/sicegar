<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Identifying the best-fitting model category • Analysis of Single-Cell Viral Growth Curves</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Identifying the best-fitting model category">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Analysis of Single-Cell Viral Growth Curves</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/additional_parameters.html">Calculation of additional parameters of interest</a></li>
    <li><a class="dropdown-item" href="../articles/categorizing_fits.html">Identifying the best-fitting model category</a></li>
    <li><a class="dropdown-item" href="../articles/fitting_individual_models.html">Fitting individual models</a></li>
    <li><a class="dropdown-item" href="../articles/h0_functions.html">Allowing the lower asymptote parameter to vary freely</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/plotting_fitted_models.html">Plotting the fitted models</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hardin47/sicegar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Identifying the best-fitting model category</h1>
                        <h4 data-toc-skip class="author">Umut Caglar,
Claus O. Wilke</h4>
            
            <h4 data-toc-skip class="date">2025-08-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hardin47/sicegar/blob/master/vignettes/categorizing_fits.Rmd" class="external-link"><code>vignettes/categorizing_fits.Rmd</code></a></small>
      <div class="d-none name"><code>categorizing_fits.Rmd</code></div>
    </div>

    
    
<p>In high-throughput scenarios, we often don’t know a priori whether a
given dataset represents a sigmoidal curve, a double-sigmoidal curve, or
neither. In these cases, we need to fit multiple different models to the
data and then determine which model best fits the data. This process is
normally done automatically by the function
<code><a href="../reference/fitAndCategorize.html">sicegar::fitAndCategorize()</a></code>. The default function assumes
that the lower asymptote (when x is at negative infinity) is zero, but
the argument <code>use_h0 = TRUE</code> can be used to estimate the
lower asymptote. In the vignette, we describe how this process works and
how the steps can be performed manually.</p>
<p>We will demonstrate this process for an artificial dataset
representing a double-sigmoidal function. We first generate the
data:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">24</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">noise_parameter</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">intensity_noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">noise_parameter</span></span>
<span><span class="va">intensity</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/doublesigmoidalFitFormula.html">doublesigmoidalFitFormula</a></span><span class="op">(</span><span class="va">time</span>,</span>
<span>                                       finalAsymptoteIntensityRatio <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>                                       maximum <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                       slope1Param <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                       midPoint1Param <span class="op">=</span> <span class="fl">7</span>,</span>
<span>                                       slope2Param <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                       midPointDistanceParam <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">intensity</span> <span class="op">&lt;-</span> <span class="va">intensity</span> <span class="op">+</span> <span class="va">intensity_noise</span></span>
<span><span class="va">dataInput</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">intensity</span><span class="op">)</span></span></code></pre></div>
<p>We need to fit the sigmoidal and double-sigmoidal models to this
dataset, using <code><a href="../reference/multipleFitFunction.html">multipleFitFunction()</a></code>. This requires first
normalizing the data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normalizedInput</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalizeData.html">normalizeData</a></span><span class="op">(</span>dataInput <span class="op">=</span> <span class="va">dataInput</span>, </span>
<span>                                                dataInputName <span class="op">=</span> <span class="st">"doubleSigmoidalSample"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit sigmoidal model</span></span>
<span><span class="va">sigmoidalModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multipleFitFunction.html">multipleFitFunction</a></span><span class="op">(</span>dataInput <span class="op">=</span> <span class="va">normalizedInput</span>,</span>
<span>                                          model <span class="op">=</span> <span class="st">"sigmoidal"</span>,</span>
<span>                                          n_runs_min <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                          n_runs_max <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                                          showDetails <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit double-sigmoidal model</span></span>
<span><span class="va">doubleSigmoidalModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multipleFitFunction.html">multipleFitFunction</a></span><span class="op">(</span>dataInput <span class="op">=</span> <span class="va">normalizedInput</span>,</span>
<span>                                                model <span class="op">=</span> <span class="st">"doublesigmoidal"</span>,</span>
<span>                                                n_runs_min <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                                n_runs_max <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                                                showDetails <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>We also need to perform the additional parameter calculations, as
these are required by the <code><a href="../reference/categorize.html">categorize()</a></code> function we use
below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate additional parameters</span></span>
<span><span class="va">sigmoidalModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parameterCalculation.html">parameterCalculation</a></span><span class="op">(</span><span class="va">sigmoidalModel</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate additional parameters</span></span>
<span><span class="va">doubleSigmoidalModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parameterCalculation.html">parameterCalculation</a></span><span class="op">(</span><span class="va">doubleSigmoidalModel</span><span class="op">)</span></span></code></pre></div>
<p>This is what the two fits look like:
<img src="categorizing_fits_files/figure-html/two_fits-1.png" width="672"></p>
<p>Clearly the sigmoidal fit is not appropriate but the double-sigmoidal
one is. Next we demonstrate how to arrive at this conclusion
computationally, using the function <code><a href="../reference/categorize.html">categorize()</a></code>. It takes
as input the two fitted models as well as a number of parameters that
are used in the decision process (explained below under “The decision
process”).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># now we can categorize the fits</span></span>
<span><span class="va">decisionProcess</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/categorize.html">categorize</a></span><span class="op">(</span>threshold_minimum_for_intensity_maximum <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                                      threshold_intensity_range <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                                      threshold_t0_max_int <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                                      parameterVectorSigmoidal <span class="op">=</span> <span class="va">sigmoidalModel</span>,</span>
<span>                                      parameterVectorDoubleSigmoidal <span class="op">=</span> <span class="va">doubleSigmoidalModel</span><span class="op">)</span></span></code></pre></div>
<p>The object returned by <code><a href="../reference/categorize.html">categorize()</a></code> contains extensive
information about the decision process, but the key component is the
<code>decision</code> variable. Here, it states that the data fits the
double-sigmoidal model:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">decisionProcess</span><span class="op">$</span><span class="va">decision</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "double_sigmoidal"</span></span></code></pre>
<p>(The possible values here are “no_signal”, “sigmoidal”,
“double_sigmoidal”, and “ambiguous”.)</p>
<div class="section level2">
<h2 id="the-decision-process">The decision process<a class="anchor" aria-label="anchor" href="#the-decision-process"></a>
</h2>
<p>The decision process consists of two parts. First, the
<code><a href="../reference/categorize.html">categorize()</a></code> function checks whether all provided input
data are valid. The steps of this verification are as follows:</p>
<ul>
<li>Pre-test 0: Was the <code><a href="../reference/categorize.html">categorize()</a></code> function provided with
sigmoidal and double_sigmoidal models as input?</li>
<li>Pre-test 1: Do the provided sigmoidal and double sigmoidal models
come from the same source and have the same data name?</li>
<li>Pre-test 2a: Was the provided sigmoidal model generated by
<code>sicegar::sigmoidalFitFunctions</code>?</li>
<li>Pre-test 2b: Was the provided double_sigmoidal model generated by
<code>sicegar::doublesigmoidalFitFunctions</code>?</li>
<li>Pre-test 3: Do both models have same scaling parameters obtained
from the data normalization process?</li>
<li>Pre-test 4a: Have the additional parameters for sigmoidal fit been
calculated by <code><a href="../reference/parameterCalculation.html">sicegar::parameterCalculation()</a></code>?</li>
<li>Pre-test 4b: Have the additional parameters for double-sigmoidal fit
been calculated by <code><a href="../reference/parameterCalculation.html">sicegar::parameterCalculation()</a></code>?</li>
</ul>
<p>After these steps, the primary decision process begins. It takes a
list of four possible outcomes (“no_signal”, “sigmoidal”,
“double_sigmoidal”, “ambiguous”) and systematically removes options
until only one remains.</p>
<p>First, the algorithm checks if the provided data includes a signal or
not.</p>
<ul>
<li>Test 1a: The observed intensity maximum must be bigger than
<code>threshold_minimum_for_intensity_maximum</code>; otherwise, the
data is labeled with <code>"no_signal"</code>.</li>
<li>Test 1b: The intensity range, i.e., the absolute difference between
the biggest and smallest observed intensity, must be greater than
<code>threshold_intensity_range</code>; otherwise, the data is labeled
with <code>"no_signal"</code>.</li>
<li>Test 1c: If at this point the data is not labeled with
<code>"no_signal"</code>, then the data can not be labeled with
<code>"no signal"</code> anymore.</li>
</ul>
<p>Next the algorithm checks if the sigmoidal and double sigmoidal
models make sense.</p>
<ul>
<li>Test 2a: The provided sigmoidal fit must be a successful fit;
otherwise, the data cannot be labeled with
<code>"sigmoidal"</code>.</li>
<li>Test 2b: The provided double-sigmoidal fit must be a successful fit;
otherwise, the data cannot labelled with
<code>"double_sigmoidal"</code>.</li>
<li>Test 3a: The sigmoidal fit must have an AIC score smaller than
<code>threshold_AIC</code>; otherwise, the data can not be labeled with
<code>"sigmoidal"</code>.</li>
<li>Test 3b: The double-sigmoidal fit must have an AIC score smaller
than <code>threshold_AIC</code>; otherwise, the data cannot be labeled
with <code>"double_sigmoidal"</code>.</li>
<li>Test 4a: The value <code>startPoint_x</code> for the sigmoidal model
must be a positive number; otherwise, the data cannot be labeled with
<code>"sigmoidal"</code>.</li>
<li>Test 4b: The value <code>startPoint_x</code> for the
double-sigmoidal model must be a positive number; otherwise, the data
cannot be labeled with <code>"double_sigmoidal"</code>.</li>
<li>Test 5a: The value <code>start_intensity</code> for the sigmoidal
model must be smaller than <code>threshold_t0_max_int</code>; otherwise,
the data cannot be labeled with <code>"sigmoidal"</code>.</li>
<li>Test 5b: The value <code>start_intensity</code> for the
double-sigmoidal model must be smaller than
<code>threshold_t0_max_int</code>; otherwise, the data cannot be labeled
with <code>"double_sigmoidal"</code>.</li>
<li>Test 6: For the double-sigmoidal model, the ratio of <em>/the
model’s intensity prediction at the last observation time/</em> to
<em>/the model’s maximum intensity prediction/</em> must be smaller than
<code>threshold_dsm_tmax_IntensityRatio</code>; otherwise, the data
cannot be labeled with <code>"double_sigmoidal"</code>.</li>
<li>Test 7: For the sigmoidal model; the ratio of <em>/the model’s
intensity prediction at the last observation time/</em> to <em>/the
model’s maximum intensity prediction/</em> must be larger than
<code>threshold_sm_tmax_IntensityRatio</code>; otherwise, the data
cannot be labeled with <code>"sigmoidal"</code>.</li>
</ul>
<p>In step eight, the algorithm checks whether the data should be
labelled as <code>"ambiguous"</code> or not.</p>
<ul>
<li>Test 8: If at this point we still have at least one of the two
options <code>"sigmoidal"</code> or <code>"double_sigmoidal"</code>,
then the data cannot be labeled with <code>"ambiguous"</code>.</li>
</ul>
<p>In the last step; the algorithm checks whether the data should be
labeled as <code>"sigmoidal"</code> or
<code>"double_sigmoidal"</code>.</p>
<ul>
<li>Test 9: If at this point we still have both the
<code>"sigmoidal"</code> and <code>"double_sigmoidal"</code> options,
then the choice will be made based on the AIC scores of those models and
value of <code>threshold_bonus_sigmoidal_AIC</code>. If
<code>sigmoidalAIC + threshold_bonus_sigmoidal_AIC  &lt;  doublesigmoidalAIC</code>,
then the data cannot be labeled with <code>"double_sigmoidal"</code>. If
<code>sigmoidalAIC + threshold_bonus_sigmoidal_AIC  &gt;  doublesigmoidalAIC</code>,
then the data cannot be labeled with <code>"sigmoidal"</code>.</li>
</ul>
<p>The only option that is left at this point will be the label of the
data and thus the final decision.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johanna Hardin, Samuel Butler, Phineus Choi, Thomas Matheis, M. Umut Caglar, Claus O. Wilke.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
