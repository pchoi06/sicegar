<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction • Analysis of Single-Cell Viral Growth Curves</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Analysis of Single-Cell Viral Growth Curves</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/additional_parameters.html">Calculation of additional parameters of interest</a></li>
    <li><a class="dropdown-item" href="../articles/categorizing_fits.html">Identifying the best-fitting model category</a></li>
    <li><a class="dropdown-item" href="../articles/fitting_individual_models.html">Fitting individual models</a></li>
    <li><a class="dropdown-item" href="../articles/h0_functions.html">Allowing the lower asymptote parameter to vary freely</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/plotting_fitted_models.html">Plotting the fitted models</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hardin47/sicegar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction</h1>
                        <h4 data-toc-skip class="author">Umut Caglar,
Claus O. Wilke</h4>
            
            <h4 data-toc-skip class="date">2025-08-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hardin47/sicegar/blob/master/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<p>The overarching aim of this package is to fit both a sigmoidal and a
double-sigmoidal curve to time–intensity data and then to determine
which of the two models fit the data best. The sigmoidal model default
is assumed to start at zero and rise to an asymptotic value. The
double-sigmoidal model first increases from 0 (default) to a maximum
intensity and the decreases to a final asymptotic intensity. For both
the sigmoid and double-sigmoid models, we provide an option to let the
lower asymptote
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mn>0</mn></msub><annotation encoding="application/x-tex">h_0</annotation></semantics></math>)
freely vary. After calculating the best candidate curves for both of
models a decision algorithm determines which of the two candidate models
(if either) fits the data best. Finally, the package estimates key
parameters that quantify the time–intensity data with respect to the
best-fitting model.</p>
<p>For the sigmoidal model, key parameters describing the curve are:</p>
<ul>
<li>maximum: The maximum asymptotic intensity.</li>
<li>midpoint: The time point at which the sigmoidal curve reaches half
of its maximum intensity.</li>
<li>slope: The slope of the curve at the midpoint.</li>
<li>(optional, not default) lower asymptote: The lower asymptote for the
intensity when time is at negative infinity</li>
</ul>
<p>For the double-sigmoidal model, key parameters describing the curve
are:</p>
<ul>
<li>maximum: The maximum intensity the double-sigmoidal curve
reaches.</li>
<li>final asymptotic intensity: The intensity the curve decreases to
after having reached its maximum.</li>
<li>midpoint 1: The time point at which the double-sigmoidal curve
reaches half of its maximum intensity during the initial rise.</li>
<li>slope 1: The slope at midpoint 1.</li>
<li>midpoint 2: The time point at which the double-sigmoidal curve
reaches the intensity corresponding to the mean of the maximum intensity
and the final asymptotic intensity.</li>
<li>slope 2: The slope at midpoint 2.</li>
<li>(optional, not default) lower asymptote: The lower asymptote for the
intensity when time is at negative infinity.</li>
</ul>
<p>Importantly, the parameters used to mathematically describe the
fitted curves do not necessarily directly correspond to these
intuitively meaningful parameters. Therefore, the
<strong>sicegar</strong> package calculates the intuitively meaningful
parameters from the estimated parameters. See the vignette on additional
parameters for details.</p>
<div class="section level2">
<h2 id="example-fit-on-simulated-input-data">Example fit on simulated input data<a class="anchor" aria-label="anchor" href="#example-fit-on-simulated-input-data"></a>
</h2>
<p>The input to the fitting function must be in the form of a data frame
with two columns called <code>time</code> and <code>intensity</code>.
Here we use double-sigmoidal data generated with arbitrarily chosen
parameters. We can use the function
<code><a href="../reference/doublesigmoidalFitFormula.html">doublesigmoidalFitFormula()</a></code> to generate a double-sigmoidal
curve, to which we add random noise.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">24</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">noise_parameter</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">intensity_noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">noise_parameter</span></span>
<span><span class="va">intensity</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/doublesigmoidalFitFormula.html">doublesigmoidalFitFormula</a></span><span class="op">(</span><span class="va">time</span>,</span>
<span>                                    finalAsymptoteIntensityRatio <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>                                    maximum <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                    slope1Param <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                    midPoint1Param <span class="op">=</span> <span class="fl">7</span>,</span>
<span>                                    slope2Param <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                    midPointDistanceParam <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">intensity</span> <span class="op">&lt;-</span> <span class="va">intensity</span><span class="op">+</span><span class="va">intensity_noise</span></span>
<span><span class="va">dataInput</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">intensity</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dataInput</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">intensity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/data_plot-1.png" width="384"></p>
<p>We can now fit the two models to the data and determine which is the
better fit. This is done with the function
<code><a href="../reference/fitAndCategorize.html">fitAndCategorize()</a></code>. The three provided threshold parameters
are used in the categorization process and depend on the units in which
the data are measured. See the vignette on categorizing fits for
details.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitAndCategorize.html">fitAndCategorize</a></span><span class="op">(</span><span class="va">dataInput</span>,</span>
<span>                           threshold_minimum_for_intensity_maximum <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                           threshold_intensity_range <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                           threshold_t0_max_int <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p>The two fitted curves can be visualized with the function
<code><a href="../reference/figureModelCurves.html">figureModelCurves()</a></code>, which returns a
<strong>ggplot2</strong> plot.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Double-sigmoidal fit with parameter related lines</span></span>
<span><span class="va">fig_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/figureModelCurves.html">figureModelCurves</a></span><span class="op">(</span>dataInput <span class="op">=</span> <span class="va">fitObj</span><span class="op">$</span><span class="va">normalizedInput</span>,</span>
<span>                                  sigmoidalFitVector <span class="op">=</span> <span class="va">fitObj</span><span class="op">$</span><span class="va">sigmoidalModel</span>,</span>
<span>                                  showParameterRelatedLines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/figureModelCurves.html">figureModelCurves</a></span><span class="op">(</span>dataInput <span class="op">=</span> <span class="va">fitObj</span><span class="op">$</span><span class="va">normalizedInput</span>,</span>
<span>                                  doubleSigmoidalFitVector <span class="op">=</span> <span class="va">fitObj</span><span class="op">$</span><span class="va">doubleSigmoidalModel</span>,</span>
<span>                                  showParameterRelatedLines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">fig_a</span>, <span class="va">fig_b</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># function from the cowplot package</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/model_plot-1.png" width="768"></p>
<p>Clearly the regular sigmoidal curve does not provide a good fit but
the double-sigmoidal curve does. This information is available from the
returned fit object:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitObj</span><span class="op">$</span><span class="va">decisionProcess</span><span class="op">$</span><span class="va">decision</span> <span class="co"># final decision</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "double_sigmoidal"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="the-fit-object">The fit object<a class="anchor" aria-label="anchor" href="#the-fit-object"></a>
</h2>
<p>The fit object returned by <code><a href="../reference/fitAndCategorize.html">fitAndCategorize()</a></code> contains
all the information potentially of interest in the course of this type
of an analysis. It consists of five distinct components:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fitObj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "normalizedInput"      "sigmoidalModel"       "doubleSigmoidalModel"</span></span>
<span><span class="co">## [4] "decisionProcess"      "summaryVector"</span></span></code></pre>
<p>Each component holds numerous parameters of interest:</p>
<ul>
<li>
<code>.$normalizedInput</code>: The normalized dataset with
normalization parameters, so that the raw dataset can be recovered from
the normalized one. For more information, see the vignette on fitting
individual models.</li>
<li>
<code>.$sigmoidalModel</code>: The parameters for the sigmoidal fit.
For more information, see the vignettes on fitting individual models and
on additional parameters.</li>
<li>
<code>.$doubleSigmoidalModel</code>: The parameters for the
double-sigmoidal fit. For more information, see the vignettes on fitting
individual models and on additional parameters.</li>
<li>
<code>.$decisionProcess</code>: The results from the decision
process of which of the two models fit the data better. For more
information, see the vignette on categorizing fits.</li>
<li>
<code>.$summaryVector</code>: Key parameters of the winning model.
These are the most important parameters extracted from either
<code>.$sigmoidalModel</code> or
<code>.$doubleSigmoidalModel</code>.</li>
</ul>
<p>The contents of the summary vector are as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">fitObj</span><span class="op">$</span><span class="va">summaryVector</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 21</span></span>
<span><span class="co">##  $ dataInputName          : logi NA</span></span>
<span><span class="co">##  $ decision               : chr "double_sigmoidal"</span></span>
<span><span class="co">##  $ maximum_x              : num 11.1</span></span>
<span><span class="co">##  $ maximum_y              : num 4.14</span></span>
<span><span class="co">##  $ midPoint1_x            : num 6.92</span></span>
<span><span class="co">##  $ midPoint1_y            : num 2.07</span></span>
<span><span class="co">##  $ midPoint2_x            : num 15</span></span>
<span><span class="co">##  $ midPoint2_y            : num 2.71</span></span>
<span><span class="co">##  $ slope1                 : num 1.05</span></span>
<span><span class="co">##  $ slope2                 : num -0.775</span></span>
<span><span class="co">##  $ finalAsymptoteIntensity: num 1.28</span></span>
<span><span class="co">##  $ incrementTime          : num 3.94</span></span>
<span><span class="co">##  $ startPoint_x           : num 4.95</span></span>
<span><span class="co">##  $ startPoint_y           : num 0</span></span>
<span><span class="co">##  $ reachMaximum_x         : num 8.89</span></span>
<span><span class="co">##  $ reachMaximum_y         : num 4.14</span></span>
<span><span class="co">##  $ decrementTime          : num 3.69</span></span>
<span><span class="co">##  $ startDeclinePoint_x    : num 13.2</span></span>
<span><span class="co">##  $ startDeclinePoint_y    : num 4.14</span></span>
<span><span class="co">##  $ endDeclinePoint_x      : num 16.9</span></span>
<span><span class="co">##  $ endDeclinePoint_y      : num 1.28</span></span></code></pre>
<p>All the parameters are defined in the vignette on additional
parameters.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johanna Hardin, Samuel Butler, Phineus Choi, Thomas Matheis, M. Umut Caglar, Claus O. Wilke.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
